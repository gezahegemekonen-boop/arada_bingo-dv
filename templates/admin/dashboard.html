<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Admin Dashboard – Arada Bingo Ethiopia</title>
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <h2>📊 Admin Dashboard</h2>
    <p>Total Players: {{ total_players }}</p>
    <p>Active Games: {{ active_games }}</p>

    <h3>💸 Pending Withdrawals</h3>
    {% for tx in pending_withdrawals %}
        <div>
            <p>User: {{ tx.user.username }} | Amount: {{ tx.amount }} birr</p>
            <form method="POST" action="{{ url_for('approve_withdrawal') }}">
                <input type="hidden" name="user_id" value="{{ tx.user.id }}">
                <input type="hidden" name="tx_id" value="{{ tx.id }}">
                <input type="hidden" name="amount" value="{{ tx.amount }}">
                <button type="submit">✅ Approve</button>
            </form>
            <form method="POST" action="{{ url_for('reject_withdrawal') }}">
                <input type="hidden" name="tx_id" value="{{ tx.id }}">
                <input type="text" name="reason" placeholder="Reason">
                <button type="submit">❌ Reject</button>
            </form>
        </div>
    {% endfor %}

    <h3>💰 Pending Deposits</h3>
    {% for tx in pending_deposits %}
        <div>
            <p>User: {{ tx.user.username }} | Amount: {{ tx.amount }} birr | Ref: {{ tx.reference }}</p>
            <form method="POST" action="{{ url_for('approve_deposit') }}">
                <input type="hidden" name="tx_id" value="{{ tx.id }}">
                <button type="submit">✅ Approve</button>
            </form>
            <form method="POST" action="{{ url_for('reject_deposit') }}">
                <input type="hidden" name="tx_id" value="{{ tx.id }}">
                <input type="text" name="reason" placeholder="Reason">
                <button type="submit">❌ Reject</button>
            </form>
        </div>
    {% endfor %}

    <h3>🎮 Games</h3>
    {% for game in games %}
        <div>
            <p>Game ID: {{ game.id }} | Status: {{ game.status }} | Pool: {{ game.pool }} birr</p>
            {% if game.status == 'waiting' %}
                <form method="POST" action="{{ url_for('start_game') }}">
                    <input type="hidden" name="game_id" value="{{ game.id }}">
                    <button type="submit">▶️ Start</button>
                </form>
            {% elif game.status == 'active' %}
                <form method="POST" action="{{ url_for('finish_game') }}">
                    <input type="hidden" name="game_id" value="{{ game.id }}">
                    <button type="submit">🏁 Finish</button>
                </form>
            {% endif %}
        </div>
    {% endfor %}

    <h3>👥 Players</h3>
    {% for player in players %}
        <div>
            <p>{{ player.username }} | Balance: {{ player.balance }} birr</p>
            <a href="{{ url_for('user_profile', user_id=player.id) }}">View Profile</a>
        </div>
    {% endfor %}

    <br><a href="{{ url_for('logout') }}">🚪 Logout</a>

    {% with messages = get_flashed_messages() %}
      {% if messages %}
        <ul>
          {% for msg in messages %}
            <li>{{ msg }}</li>
          {% endfor %}
        </ul>
      {% endif %}
    {% endwith %}
</body>
</html>
